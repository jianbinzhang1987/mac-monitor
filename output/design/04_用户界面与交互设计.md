# 04_用户界面与交互设计

## 1. 技术栈选型
    
*   **框架**: **Tauri v2 Beta** (Rust + Webview) - 提供更强的插件系统和移动端支持能力。
*   **前端**: Vue 3.4+ & TypeScript.
*   **UI 组件库**: **Ant Design Vue 4.x** (遵循 Ant Design 5.0 规范，提供更现代的设计).
*   **构建工具**: Vite 5.x.
*   **状态管理**: Pinia.

## 2. 界面交互流程

### 2.1 登录页 (Login View)
*   **输入**: 用户名、密码。
*   **反馈**: 登录加载动画。
*   **逻辑**: 调用 Rust 侧 `login` 接口，成功后跳转主页并持久化 Token。

### 2.2 主界面 (Dashboard)
*   **状态栏**: 顶部显示“网络已连接/审计中”、“安全状态：正常”。
*   **POP 点选择**:
    *   下拉菜单展示可用 POP 节点（名称、延迟 ms）。
    *   支持手动切换，切换时触发 Rust 侧网络重连。
*   **功能区**:
    *   “检测更新”: 手动触发软件升级。
    *   “故障诊断”: 导出本地日志。
    *   “关于”: 显示版本号、设备 ID。

### 2.3 托盘菜单 (System Tray)
*   **主窗口隐藏**: 点击关闭按钮默认最小化到托盘。
*   **菜单项**:
    *   显示主界面
    *   POP 点快速切换
    *   退出客户端 (需管理员密码确认)

## 3. 应用生命周期

### 3.1 启动流程
1.  **Init**: 加载配置，检查单例互斥 (Mutex)。
2.  **Service Check**: 检查 Helper/Audit Daemon 是否运行，若未运行尝试启动或提示修复。
3.  **UI Render**: 渲染登录页或主页（若有有效 Token）。

### 3.2 退出流程
*   用户点击“退出客户端”。
*   **鉴权**: 弹出系统密码框或应用内密码框验证权限。
*   **Cleanup**:
    *   停止 Network Extension (恢复系统网络设置)。
    *   发送“离线”信号给服务端。
    *   终止所有子进程。

## 4. 界面更新与动态化
*   **动态配置**: 部分 UI 文案或入口可以根据 `GET /config` 接口返回的参数进行隐藏或更改。
*   **热更新**: 虽然 Tauri 核心二进制更新需重新安装，但前端资源 (HTML/JS/CSS) 可考虑基于 `tauri-plugin-updater` 的全量更新机制。
